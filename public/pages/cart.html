<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/styles.css" />
    <title>Web Design Mastery | Cart</title>
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav>
      <div class="nav__header">
        <div class="nav__logo">
          <a href="#">
            <img
              src="../assets/logo-dark.png"
              alt="logo-dark"
              class="logo-dark"
            />
            <img
              src="../assets/logo-white.png"
              alt="logo-white"
              class="logo-white"
            />
          </a>
        </div>
        <div class="nav__menu__btn" id="menu-btn">
          <i class="ri-menu-line"></i>
        </div>
      </div>
      <ul class="nav__links" id="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href="/products">Products</a></li>
        <li><a href="/about">About Us</a></li>
        <li><a href="/contact">Contact</a></li>
        <li><a href="/cart"><i class="ri-shopping-cart-line"></i></a></li>


      </ul>
    </nav>

    <!-- Cart Section -->
    <section class="section__container cart__container">
      <h2 class="section__header">YOUR CART</h2>
      <div class="cart__content" id="cart-content">
        <!-- Cart items will be dynamically inserted here -->
      </div>
      <div class="cart__total">
        <h3>Total: <span id="cart-total">$0.00</span></h3>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="section__container footer__container">
        <div class="footer__col">
          <h4>Our Information</h4>
          <ul class="footer__links">
            <li><a href="#">Return Policy</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms & Condition</a></li>
            <li><a href="#">Site Map</a></li>
            <li><a href="#">Store House</a></li>
          </ul>
        </div>
        <div class="footer__col">
          <h4>About Us</h4>
          <ul class="footer__links">
            <li><a href="#">Support Center</a></li>
            <li><a href="#">Customer Support</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Copy Right</a></li>
            <li><a href="#">Popular Campaign</a></li>
          </ul>
        </div>
        <div class="footer__col">
          <h4>Product</h4>
          <ul class="footer__links">
            <li><a href="#">Sports Watches</a></li>
            <li><a href="#">Cornographic Watches</a></li>
            <li><a href="#">Digital Watches</a></li>
            <li><a href="#">Mechanical Watches</a></li>
            <li><a href="#">Accessories</a></li>
          </ul>
        </div>
        <div class="footer__col">
          <h4>Support</h4>
          <ul class="footer__links">
            <li><a href="#">Product Help</a></li>
            <li><a href="#">Service & Warranty</a></li>
            <li><a href="#">Righting Beats</a></li>
            <li><a href="#">Authorizes Service</a></li>
            <li><a href="#">Customer Care</a></li>
          </ul>
        </div>
      </div>
      <div class="footer__bar">
        Copyright Â© 2024 Web Design Mastery. All rights reserved.
      </div>
    </footer>

    
    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const cartContent = document.getElementById("cart-content");
          const cartTotal = document.getElementById("cart-total");
      
          function loadCart() {
            fetch("/cart-items")
              .then((response) => response.json())
              .then((cartItems) => {
                cartContent.innerHTML = "";
                let total = 0;
      
                cartItems.forEach((item) => {
                  total += item.price * item.quantity;
                  cartContent.innerHTML += `
                    <div class="cart-item" data-id="${item.id}">
                      <img src="${item.image}" alt="${item.name}" class="cart-item-image"/>
                      <div class="cart-item-details">
                        <h4>${item.name}</h4>
                        <p>$${item.price} x <span class="quantity">${item.quantity}</span></p>
                        <div class="cart-item-controls">
                          <button class="btn decrease-qty">-</button>
                          <span class="qty">${item.quantity}</span>
                          <button class="btn increase-qty">+</button>
                          <button class="btn remove-item">Remove</button>
                        </div>
                      </div>
                    </div>
                  `;
                });
      
                cartTotal.innerText = `$${total.toFixed(2)}`;
      
                addEventListeners();
              })
              .catch((error) => console.error("Error:", error));
          }
      
          function addEventListeners() {
            document.querySelectorAll(".increase-qty").forEach((btn) => {
              btn.addEventListener("click", (event) => {
                const productCard = event.target.closest(".cart-item");
                const productId = productCard.dataset.id;
                updateCartItem(productId, "increase");
              });
            });
      
            document.querySelectorAll(".decrease-qty").forEach((btn) => {
              btn.addEventListener("click", (event) => {
                const productCard = event.target.closest(".cart-item");
                const productId = productCard.dataset.id;
                updateCartItem(productId, "decrease");
              });
            });
      
            document.querySelectorAll(".remove-item").forEach((btn) => {
              btn.addEventListener("click", (event) => {
                const productCard = event.target.closest(".cart-item");
                const productId = productCard.dataset.id;
                removeCartItem(productId);
              });
            });
          }
      
          function updateCartItem(productId, action) {
            fetch("/update-cart", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ id: productId, action }),
            })
              .then((response) => response.json())
              .then(() => loadCart()) // Reload cart after update
              .catch((error) => console.error("Error:", error));
          }
      
          function removeCartItem(productId) {
  fetch("/remove-from-cart", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ id: productId }),
  })
    .then((response) => response.json()) // Expecting JSON response
    .then(() => loadCart()) // Reload cart after removing item
    .catch((error) => console.error("Error:", error));
}

      
          loadCart();
        });
      </script>
      
  </body>
</html>